var ApplicationConfiguration=function(){"use strict";var e="la-vendimia",t=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils","LocalStorageModule","naif.base64","angularFileUpload","hc.marked","duScroll","ncy-angular-breadcrumb","angular-growl","localytics.directives","cfp.loadingBar","constantConfig","ngTable","ui.grid","ui.grid.pagination","ui.grid.autoResize","oitozero.ngSweetAlert","ui.tree","mgo-angular-wizard","textAngular","dndLists","ui.calendar","blockUI","chart.js","ui.knob","ui.select"],n=function(t){angular.module(t,[]),angular.module(e).requires.push(t)};return{applicationModuleName:e,applicationModuleVendorDependencies:t,registerModule:n}}();!function(){"use strict";angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$breadcrumbProvider","$httpProvider","$locationProvider","$logProvider","$provide","blockUIConfig","growlProvider","localStorageServiceProvider",function(e,t,n,o,a,i,r,l){var c=0;o.debugEnabled(!0),a.decorator("uibAccordionDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/accordionAce.html",e}]),a.decorator("uibAccordionGroupDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/accordiongroup.html",e}]),a.decorator("uibDaypickerDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/day.html",e}]),a.decorator("uibDatepickerPopupWrapDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/popup.html",e}]),a.decorator("uibYearpickerDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/year.html",e}]),a.decorator("uibMonthpickerDirective",["$delegate",function(e){return c=e[0],c.templateUrl="./app/modules/core/views/templates/month.html",e}]),i.message="Cargando, espere por favor...",i.autoBlock=!1,i.delay=0,i.template='<div class="block-ui-overlay"></div><div class="block-ui-message-container" aria-live="assertive" aria-atomic="true"><div class="block-ui-message" ng-class="$_blockUiMessageClass"><i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i> {{ state.message }}</div></div>',n.hashPrefix("!"),e.setOptions({prefixStateName:"app",templateUrl:"./app/modules/core/views/breadcrumb.view.html"}),r.onlyUniqueMessages(!0),r.messagesKey("mensajes"),r.messageTextKey("mensaje"),r.messageTitleKey("titulo"),r.messageSeverityKey("severidad"),r.globalDisableIcons(!1),r.globalTimeToLive({error:-1,info:3e3,success:3e3,warning:-1}),t.interceptors.push(r.serverMessagesInterceptor),t.interceptors.push("RequestsInterceptor"),l.setStorageType("sessionStorage"),l.setPrefix("cpl.la-vendimia")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])})}(),function(){"use strict";ApplicationConfiguration.registerModule("core")}(),function(){"use strict";angular.module("core").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise(function(e){var t=e.get("$state");t.go("app.home")}),e.state("app",{"abstract":!0,views:{root:{templateUrl:"./app/modules/core/views/core.view.html"}}})}])}(),function(){"use strict";angular.module("core").factory("focusElem",["$rootScope","$timeout",function(e,t){return function(n){t(function(){e.$broadcast("coppelFocusOn",n)})}}])}(),function(){"use strict";angular.module("core").factory("requestHuella",["$http","$q","Config",function(e,t,n){var o=function(){return e({method:"GET",url:n.webbridge}).then(function(e){return e.data},function(e){var n={error:"Verificar que se encuentre instalado el servicio de Huella (WebBridge)"};return t.reject(n)})};return{huella:o}}])}(),function(){"use strict";angular.module("core").directive("delayEnter",["$timeout",function(e){return{link:function(t,n,o,a){n.bind("keydown keypress",function(n){13===n.which&&(e(o.delayEnter||500),void 0!==a.$modelValue&&t.$apply(function(){t.$eval(o.delayEnter)}))})},require:"^?ngModel",restrict:"A"}}])}(),function(){"use strict";angular.module("core").directive("focusOn",function(){return function(e,t,n){e.$on("focusOn",function(e,o){o===n.focusOn&&(t[0].focus(),"text"===n.type&&t[0].select())})}})}(),function(){"use strict";angular.module("core").directive("soloLetras",function(){return{link:function(e,t,n,o){var a=function(e){var t="";return e?(t=e.replace(/[^a-zA-Z\s]/g,""),t!==e&&(o.$setViewValue(t),o.$render()),t):""};o.$parsers.push(a)},require:"^?ngModel"}})}(),function(){"use strict";angular.module("core").directive("soloLetrasNumeros",function(){return{link:function(e,t,n,o){var a=function(e){var t="";return e?(t=e.replace(/[^a-zA-ZñÑáéíóúÁÉÍÓÚ^0-9\s]/g,""),t!==e&&(o.$setViewValue(t),o.$render()),t):""};o.$parsers.push(a)},require:"^?ngModel"}})}(),function(){"use strict";angular.module("core").directive("soloNumeros",function(){return{link:function(e,t,n,o){var a=function(e){var t="";return e?(t=e.replace(/(?!^-)[^0-9.]/g,""),t!==e&&(o.$setViewValue(t),o.$render()),t):""};o.$parsers.push(a)},require:"^?ngModel"}})}(),function(){"use strict";angular.module("core").directive("soloNumerosSinPunto",function(){return{link:function(e,t,n,o){var a=function(e){var t="";return e?(t=e.replace(/(?!^-)[^0-9]/g,""),t!==e&&(o.$setViewValue(t),o.$render()),t):""};o.$parsers.push(a)},require:"^?ngModel"}})}(),function(){"use strict";ApplicationConfiguration.registerModule("articulos")}(),function(){"use strict";ApplicationConfiguration.registerModule("clientes")}(),function(){"use strict";ApplicationConfiguration.registerModule("configuracion")}(),function(){"use strict";ApplicationConfiguration.registerModule("home")}(),function(){"use strict";ApplicationConfiguration.registerModule("menu")}(),function(){"use strict";ApplicationConfiguration.registerModule("navbar")}(),function(){"use strict";ApplicationConfiguration.registerModule("niveles")}(),function(){"use strict";ApplicationConfiguration.registerModule("users")}(),function(){"use strict";ApplicationConfiguration.registerModule("ventas")}(),function(){"use strict";angular.module("articulos").config(["$stateProvider",function(e){e.state("app.articulos",{ncyBreadcrumb:{label:"Articulos"},url:"/articulos",views:{"content@app":{controller:"Articulos",controllerAs:"vm",templateUrl:"./app/modules/articulos/views/articulos.view.html"}}})}])}(),function(){"use strict";angular.module("clientes").config(["$stateProvider",function(e){e.state("app.clientes",{ncyBreadcrumb:{label:"Clientes"},url:"/clientes",views:{"content@app":{controller:"Clientes",controllerAs:"vm",templateUrl:"./app/modules/clientes/views/clientes.view.html"}}})}])}(),function(){"use strict";angular.module("configuracion").config(["$stateProvider",function(e){e.state("app.configuracion",{ncyBreadcrumb:{label:"Configuracion"},url:"/configuracion",views:{"content@app":{controller:"Configuracion",controllerAs:"vm",templateUrl:"./app/modules/configuracion/views/configuracion.view.html"}}})}])}(),function(){"use strict";angular.module("home").config(["$stateProvider",function(e){e.state("app.home",{ncyBreadcrumb:{label:" "},url:"/home",views:{"content@app":{controller:"Home",controllerAs:"vmHome",templateUrl:"./app/modules/home/views/home.view.html"}}})}])}(),function(){"use strict";angular.module("niveles").config(["$stateProvider",function(e){e.state("app.niveles",{ncyBreadcrumb:{label:"Niveles"},url:"/niveles"}).state("app.niveles.item1",{ncyBreadcrumb:{label:"Item 1"},url:"/item1",views:{"content@app":{controller:"Niveles",controllerAs:"vmNiveles",templateUrl:"./app/modules/niveles/views/niveles.view.html"}}}).state("app.niveles.item2",{ncyBreadcrumb:{label:"Item 2"},url:"/item2"}).state("app.niveles.item2.detalle",{ncyBreadcrumb:{label:"Detalle"},url:"/detalle",views:{"content@app":{controller:"Niveles",controllerAs:"vmNiveles",templateUrl:"./app/modules/niveles/views/niveles.view.html"}}})}])}(),function(){"use strict";angular.module("users").config(["$stateProvider",function(e){e.state("login",{url:"/login",views:{root:{templateUrl:"./app/modules/users/views/login.view.html"}}})}])}(),function(){"use strict";angular.module("users").run(["$location","$rootScope","$state","$timeout","$window","Authentication","Config","blockUI","growlMessages",function(e,t,n,o,a,i,r,l,c){var s=e.search().token,u="",d="",p=function(){d=t.$on("$stateChangeStart",function(e,o,a){i.isAuth()||"login"===o.name||(t.returnToState=o.name,t.returnToStateParams=a,i.logout(),e.preventDefault()),"login"===o.name&&i.isAuth()===!0&&(n.go("app.home"),e.preventDefault())})};return"Produccion"===r.enviroment&&(l.start(),s?i.loginAutomatico(s).then(function(e){p()}):i.isAuth()?(l.stop(),p()):o(function(){a.location.href=r.redirect})),u=t.$on("$stateChangeSuccess",function(e,n){o(function(){i.isAuth()&&t.$broadcast("autoLogIn"),t.$broadcast("menuRefresh",{state:n})}),c.destroyAllMessages(),e.preventDefault()}),!1}])}(),function(){"use strict";angular.module("ventas").config(["$stateProvider",function(e){e.state("app.ventas",{ncyBreadcrumb:{label:"Ventas"},url:"/ventas",views:{"content@app":{controller:"Ventas",controllerAs:"vm",templateUrl:"./app/modules/ventas/views/ventas.view.html"}}})}])}(),function(){"use strict";angular.module("articulos").factory("Servarticulos",["$http","$q","Config",function(e,t,n){var o=function(){return e({method:"GET",url:n.api+"/articulos"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},a=function(){return e({method:"GET",url:n.api+"/idarticulo"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},i=function(o,a,i,r,l,c){return e({method:"PUT",url:n.api+"/articulo/"+o+"/"+a+"/"+i+"/"+r+"/"+l+"/"+c}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},r=function(o){return e({method:"DELETE",url:n.api+"/articulo/"+o}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})};return{consultarArticulos:o,obtenerSiguiente:a,guardarArticulo:i,eliminarArticulo:r}}])}(),function(){"use strict";angular.module("clientes").factory("Servclientes",["$http","$q","Config",function(e,t,n){var o=function(){return e({method:"GET",url:n.api+"/clientes"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},a=function(){return e({method:"GET",url:n.api+"/idcliente"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},i=function(o,a,i,r,l,c){return e({method:"PUT",url:n.api+"/cliente/"+o+"/"+a+"/"+i+"/"+r+"/"+l+"/"+c}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},r=function(o){return e({method:"DELETE",url:n.api+"/cliente/"+o}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})};return{consultarClientes:o,consultarIdCliente:a,guardarCliente:i,eliminarCliente:r}}])}(),function(){"use strict";angular.module("configuracion").factory("Servconfig",["$http","$q","Config",function(e,t,n){var o=function(){return e({method:"GET",url:n.api+"/recurso"}).then(function(e){return e.data},function(e){return t.reject(e)})},a=function(){return e({method:"GET",url:n.api+"/configuracion"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},i=function(o,a,i,r){return e({method:"PUT",url:n.api+"/configuracion/"+o+"/"+a+"/"+i+"/"+r}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})};return{someMethod:o,cargarConfig:a,guardarConfig:i}}])}(),function(){"use strict";angular.module("menu").factory("servicioMenu",["$http","$q",function(e,t){var n=function(){return e({method:"GET",url:"app/modules/menu/services/menu.json"}).then(function(e){return e.data},function(e){return t.reject(e)})};return{getMenu:n}}])}(),function(){"use strict";angular.module("users").service("Authentication",["$http","$log","$rootScope","$urlRouter","$window","Config","localStorageService",function(e,t,n,o,a,i,r){var l=this,c=function(e,t){l.user=e,l.accessToken=t,r.set("user",e),r.set("access_token",t),n.$broadcast("autoLogIn")},s=function(){l.user=null,l.accessToken=null,r.remove("user","access_token"),a.location.href=i.redirect};l.user=r.get("user"),l.accessToken=r.get("access_token"),this.login=function(e){return!0},this.loginAutomatico=function(n){return e({data:{token:n},method:"POST",url:i.ssoDesarrollo+"/v1/verify"}).then(function(r){return e({data:{token:n},method:"POST",url:i.ssoDesarrollo+"/v1/me"}).then(function(e){o.listen(),t.info(e),c(e.data.data,n)},function(e){a.location.href=i.redirect}),r},function(e){a.location.href=i.redirect})},this.logout=function(){s()},this.isAuth=function(){return!!r.get("access_token")},this.currentUser=function(){return r.get("user")}}])}(),angular.module("users").service("RequestsInterceptor",["$location","$q","Config","localStorageService",function(e,t,n,o){var a=401,i=403,r="";this.request=function(e){return e.url!==n.webbridge&&(r=o.get("access_token"),r&&(e.headers.Authorization=r)),e},this.responseError=function(r){switch(r.status){case a:o.remove("user","access_token"),e.path(n.redirect);break;case i:}return t.reject(r)}}]),function(){"use strict";angular.module("ventas").factory("Servventas",["$http","$q","Config",function(e,t,n){var o=function(){return e({method:"GET",url:n.api+"/ventas"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},a=function(){return e({method:"GET",url:n.api+"/folio"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},i=function(){return e({method:"GET",url:n.api+"/configuracion"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},i=function(){return e({method:"GET",url:n.api+"/configuracion"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},r=function(o){return e({method:"GET",url:n.api+"/existencia/"+o}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},l=function(){return e({method:"GET",url:n.api+"/datoscliente"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},c=function(){return e({method:"GET",url:n.api+"/datosarticulo"}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},s=function(o,a,i){return e({method:"PUT",url:n.api+"/existencia/"+o+"/"+a+"/"+i}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},u=function(o){return e({method:"PUT",url:n.api+"/venta",data:o}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})},d=function(o){return e({method:"DELETE",url:n.api+"/venta/"+o}).then(function(e){return e.data.data.response},function(e){return t.reject(e)})};return{consultarVentas:o,consultarFolio:a,obtenerConfirugacion:i,validarExistencia:r,actualizarExistencia:s,grabarVenta:u,obtenerDatosCliente:l,obtenerDatosArticulo:c,eliminarVenta:d}}])}(),function(){"use strict";angular.module("menu").directive("coppelMenu",["$rootScope","$state","$timeout",function(e,t,n){return{link:function(o,a){var i="";n(function(){var e=300;a.on("click","li a",function(t){var n=angular.element(this),o=n.next(),a="",i="";o.is(".submenu")&&o.is(":visible")?(o.slideUp(e,function(){o.removeClass("menu-open")}),n.parent().hasClass("active")&&n.parent().removeClass("open")):o.is(".submenu")&&!o.is(":visible")&&(a=n.parents("ul").first(),i=a.find("ul:visible").slideUp(e),i.removeClass("menu-open"),i.parent().hasClass("active")&&i.parent().removeClass("open"),n.parent().hasClass("active")&&n.parent().addClass("open"),o.slideDown(e,function(){o.addClass("menu-open")})),o.is(".submenu")&&t.preventDefault()})}),o.customFilter=function(e,t){var n=0,a=null;if(e.hasOwnProperty("state")&&e.state===t)return e;for(n=0;n<Object.keys(e).length;n++)if(angular.isObject(e[Object.keys(e)[n]])&&(a=o.customFilter(e[Object.keys(e)[n]],t),null!==a))return a;return null},o.collapseAll=function(){var e=0,t=0,n=0;for(e in o.menuData)if(o.menuData[e].show=!1,o.menuData[e].active=!1,o.menuData[e].nodes.length>0)for(t in o.menuData[e].nodes)if(o.menuData[e].nodes[t].show=!1,o.menuData[e].nodes[t].active=!1,o.menuData[e].nodes[t].nodes.length>0)for(n in o.menuData[e].nodes[t].nodes)o.menuData[e].nodes[t].nodes[n].show=!1,o.menuData[e].nodes[t].nodes[n].active=!1},o.handleMenu=function(e){var t=o.customFilter(o.menuData,e),n=e.split(".");3===n.length?t=o.customFilter(o.menuData,"app."+n[1]+"."+n[2]):n.length>3&&(t=o.customFilter(o.menuData,"app."+n[1]+"."+n[2]+"."+n[3])),null!==t&&o.expand(t)},o.expand=function(e){var t=0,n=0,a=0;o.collapseAll();for(t in o.menuData)for(n in o.menuData[t].nodes){if(o.menuData[t].nodes[n].name===e.name){o.menuData[t].active=!0,o.menuData[t].show=!0,e.active=!0;break}if(o.menuData[t].nodes[n].nodes.length>0)for(a in o.menuData[t].nodes[n].nodes)if(o.menuData[t].nodes[n].nodes[a].name===e.name){o.menuData[t].show=!0,o.menuData[t].nodes[n].show=!0,e.active=!0;break}}},i=e.$on("menuRefresh",function(e,n){o.$watch("menuData",function(e){e&&(o.collapseAll(),o.handleMenu(t.current.name))})})},restrict:"E",scope:{menuData:"="},templateUrl:"./app/modules/menu/views/menu.view.html"}}])}(),function(){"use strict";angular.module("users").directive("coppelEnter",[function(){return{link:function(e,t,n,o){t.bind("keydown keypress",function(t){13===t.which&&(angular.isDefined(o.$modelValue)&&e.$apply(function(){e.$eval(n.coppelEnter)}),t.preventDefault())})},require:"^?ngModel"}}])}(),function(){"use strict";angular.module("clientes").controller("Clientes",["SweetAlert","Servclientes","blockUI",function(e,t,n){var o=this,a=t;o.seccionNuevo=!1,o.claveCliente=null,o.nomBoton="Guardar",o.nombre=null,o.apPaterno=null,o.apMaterno=null,o.rfc=null,o.clientes=[],o.actualizar=0,o.gridOptions={onRegisterApi:function(e){o.gridApi=e},enablePaginationControls:!1,enableFullRowSelection:!1,enableRowSelection:!1,enableSelectAll:!0,selectionRowHeaderWidth:35,enableRowHeaderSelection:!0,enableColumnMenus:!1,enableSorting:!0,enableFiltering:!1,showColumnFooter:!1,columnDefs:[{field:"clave",displayName:"Clave Cliente",width:"10%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.clave}}" ng-bind-html="row.entity.clave">{{row.entity.clave}}</div>'},{field:"nombre",displayName:"Nombre",width:"30%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.nombre}}" ng-bind-html="row.entity.nombre">{{row.entity.nombre}}</div>'},{field:"appaterno",displayName:"Apellido Paterno",width:"20%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.appaterno}}" ng-bind-html="row.entity.appaterno">{{row.entity.appaterno}}</div>'},{field:"apmaterno",displayName:"Apellido Materno",width:"15%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.apmaterno}}" ng-bind-html="row.entity.apmaterno">{{row.entity.apmaterno}}</div>'},{field:"rfc",displayName:"RFC",width:"15%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.rfc}}" ng-bind-html="row.entity.rfc">{{row.entity.rfc}}</div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.editarCliente(row)"> <i class="fa fa-edit" style="font-size:25px;color:green" title = "Editar Cliente"></i> </a> </div> </div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.eliminarRenglon(row)"> <i class="fa fa-remove" style="font-size:25px;color:red" title = "Eliminar Cliente"></i> </a> </div> </div>'}],data:o.clientes},o.eliminarRenglon=function(e){var t=parseInt(e.entity.clave),n=o.gridApi.grid.renderContainers.body.visibleRowCache.indexOf(e);swal({title:"",text:"¿Está seguro de eliminar al cliente del catálogo?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"OK",cancelButtonText:"Cancelar",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&a.eliminarCliente(t).then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):(swal("",e.mensaje,"success"),o.clientes.splice(n,1),o.gridOptionsVenta.data=o.clientes)},function(e){swal("","Ocurrió un error al conectar con el servicio [eliminarRenglon]","error")})})},o.consultarClientes=function(){n.start("Cargando..."),a.consultarClientes().then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),n.stop()):(o.clientes=e.data,o.gridOptions.data=o.clientes,n.stop())},function(e){swal("","Ocurrió un error al conectar con el servicio [consultarEmpleados]","error"),n.stop()})},o.consultarClientes(),o.consultarId=function(){a.consultarIdCliente().then(function(e){1!=e.estatus?swal({title:"",text:e.mensaje,type:"error",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&o.cancelar()}):o.claveCliente=e.data.sig_id},function(e){swal("","Ocurrió un error al conectar con el servicio [consultarId]","error")})},o.altaNuevo=function(){o.seccionNuevo=!0,o.nombre=null,o.apPaterno=null,o.apMaterno=null,o.rfc=null,o.nomBoton="Guardar",o.consultarId()},o.guardar=function(){var e=parseInt(o.claveCliente);null==o.nombre||""==o.nombre?(alert("No es posible continuar, debe ingresar la Nombre, es obligatorio"),document.getElementById("txtNombre").focus()):null==o.apPaterno||""==o.apPaterno?(alert("No es posible continuar, debe ingresar el Apellido Paterno, es obligatorio"),document.getElementById("txtApPaterno").focus()):null==o.rfc||""==o.rfc?(alert("No es posible continuar, debe ingresar el RFC, es obligatorio"),document.getElementById("txtRFC").focus()):null==o.apMaterno||""==o.apMaterno?document.getElementById("txtApMaterno").focus():(n.start("Guardando información..."),a.guardarCliente(o.actualizar,o.nombre,o.apPaterno,o.apMaterno,o.rfc,e).then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),n.stop()):(n.stop(),swal({title:"",text:e.mensaje,type:"success",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&(o.seccionNuevo=!1,o.consultarClientes())}))},function(e){n.stop(),swal("","Ocurrió un error al conectar con el servicio [guardar]","error")}))},o.editarCliente=function(e){o.nomBoton="Actualizar",o.actualizar=1,o.nombre=e.entity.nombre,o.apPaterno=e.entity.appaterno,o.apMaterno=e.entity.apmaterno,o.rfc=e.entity.rfc,o.claveCliente=e.entity.clave,o.seccionNuevo=!0},o.cancelar=function(){o.nombre=null,o.apPaterno=null,o.apMaterno=null,o.rfc=null,o.seccionNuevo=!1,o.claveCliente=null,o.clientes=[],o.actualizar=0,o.nomBoton="Guardar",o.consultarClientes()}}])}(),function(){"use strict";angular.module("configuracion").controller("Configuracion",["Servconfig","SweetAlert","$state","blockUI",function(e,t,n,o){var a=this,i=e;a.tasa=null,a.porcentaje=null,a.plazo=null,a.estatus=null,i.cargarConfig().then(function(e){o.start("Cargando..."),1!=e.estatus?(document.getElementById("txtTasaFinanciamiento").focus(),a.estatus=-1,o.stop()):(a.tasa=e.data.tasa,a.porcentaje=e.data.porcentaje,a.plazo=e.data.plazo,a.estatus=1,o.stop())},function(e){swal("","Ocurrió un error al conectar con el servicio [cargarConfig]","error"),o.stop()}),a.guardar=function(){null==a.tasa&&null==a.porcentaje&&null==a.plazo?swal("","No se ha capturado ninguna configuración, favor de revisar","warning"):(o.start("Guardando información..."),null!=a.tasa&&""!=a.tasa||(a.tasa=0),null!=a.porcentaje&&""!=a.porcentaje||(a.porcentaje=0),null!=a.plazo&&""!=a.plazo||(a.plazo=0),i.guardarConfig(a.estatus,a.tasa,a.porcentaje,a.plazo).then(function(e){1!=e.estatus?(o.stop(),swal("",e.mensaje,"error")):(o.stop(),swal("",e.mensaje,"success"))},function(e){o.stop(),swal("","Ocurrió un error al conectar con el servicio [guardarConfig]","error")}))},a.cancelar=function(){n.go("app.home")}}])}(),function(){"use strict";angular.module("home").controller("Home",[function(){var e=this;e.titulo="Titulo"}])}(),function(){"use strict";angular.module("menu").controller("Menu",["$rootScope","$scope","servicioMenu",function(e,t,n){var o=this;o.collapseMenu=!0,o.toggleMenu=function(){o.collapseMenu=!o.collapseMenu},o.isLoginScreen=!1,n.getMenu().then(function(t){o.tree=t.data.menu,e.$broadcast("menuRefresh")}),t.$on("toggleMenu",function(e,t){o.displayMenu=t})}])}(),function(){"use strict";angular.module("navbar").controller("Header",["$rootScope","$scope","Authentication","Config","blockUI",function(e,t,n,o,a){var i=this;i.hojaAzul=o.hojaAzul,i.btnToggler=!1,i.isCollapsed=!1,i.isLoginScreen=!1,i.usuario={},i.fecha=new Date,i.dia=i.fecha.getDate(),i.mes=i.fecha.getMonth()+1,i.anio=i.fecha.getFullYear(),i.fecActual=i.dia+"/"+i.mes+"/"+i.anio,i.fecActual=moment(i.fecActual).format("MM/DD/YYYY"),t.$on("autoLogIn",function(e,t){i.usuario=n.currentUser(),a.stop()}),i.toggleCollapsibleMenu=function(){i.isCollapsed=!i.isCollapsed},t.$on("$stateChangeSuccess",function(e,t,n,o,a){i.isCollapsed=!1,i.isLoginScreen=!1,"login"===t.name&&(i.isLoginScreen=!0)}),i.toggleMenu=function(){i.btnToggler=!i.btnToggler,e.$broadcast("toggleMenu",i.btnToggler)},i.logout=function(){n.logout()}}])}(),function(){"use strict";angular.module("niveles").controller("Niveles",[function(){var e=this;e.info=""}])}(),function(){"use strict";angular.module("users").controller("Authentication",["$scope","Authentication",function(e,t){var n=this;n.user={},n.alerts=[],n.addAlert=function(e){n.alerts.push({msg:e,type:"danger"})},n.closeAlert=function(e){n.alerts.splice(e,1)},n.login=function(){t.login(e.user)}}])}(),function(){"use strict";angular.module("ventas").controller("Ventas",["Servventas","SweetAlert","Config","$scope","blockUI","$state",function(e,t,n,o,a,i){var r=this,l=e;r.nombreCliente=null,r.clienteSelecto=null,r.articuloSelecto=null,r.ventas=[],r.plazos=[3,6,9,12],r.tablaAbonos=[],r.configuracion=[],r.registroVentas=[],r.enganche=0,r.bonifEnganche=0,r.totalPagar=0,r.nombreBoton="Siguiente",r.totalAdeudo=0,r.precioContado=0,r.claveCliente=null,r.nomCliente=null,r.plazoSeleccionado=null,r.abonoSeleccionado=null,r.ahorroSeleccionado=null,r.totalPagarSelecc=null,r.unidades=null,r.claveArticulo=null,r.datosCliente=[],r.datosArticulo=[],r.rfcCliente=null,r.verRFC=!1,r.siguiente=!1,r.verTabla=!1,r.seccionNuevo=!1,r.guardar=!1,r.folioVenta=null,r.deshabilCliente=!1,r.deshabilitaArticulo=!0,r.gridOptions={onRegisterApi:function(e){r.gridApi=e},enablePaginationControls:!1,enableFullRowSelection:!1,enableRowSelection:!1,enableSelectAll:!0,selectionRowHeaderWidth:35,enableRowHeaderSelection:!0,enableColumnMenus:!1,enableSorting:!0,enableFiltering:!1,showColumnFooter:!1,columnDefs:[{field:"folio",displayName:"Folio Venta",width:"10%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.folio}}" ng-bind-html="row.entity.folio">{{row.entity.folio}}</div>'},{field:"clavecliente",displayName:"Clave Cliente",width:"10%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.clavecliente}}" ng-bind-html="row.entity.clavecliente">{{row.entity.clavecliente}}</div>'},{field:"nombre",displayName:"Nombre",width:"35%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.nombre}}" ng-bind-html="row.entity.nombre">{{row.entity.nombre}}</div>'},{field:"total",displayName:"Total",width:"20%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.total}}" ng-bind-html="row.entity.total">{{row.entity.total}}</div>'},{field:"fecha",displayName:"Fecha",width:"15%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.fecha}}" ng-bind-html="row.entity.fecha">{{row.entity.fecha}}</div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.verDetalle(row)"> <i class="fa fa-list-alt" style="font-size:25px;color:green" title = "Ver Detalle"></i> </a> </div> </div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.eliminarRenglonVenta(row)"> <i class="fa fa-remove" style="font-size:25px;color:red" title = "Eliminar Venta"></i> </a> </div> </div>'}],data:r.ventas},r.gridOptionsVenta={onRegisterApi:function(e){r.gridApiVenta=e},enablePaginationControls:!1,enableFullRowSelection:!1,enableRowSelection:!1,enableSelectAll:!0,selectionRowHeaderWidth:35,enableRowHeaderSelection:!0,enableColumnMenus:!1,enableSorting:!0,enableFiltering:!1,showColumnFooter:!1,columnDefs:[{field:"id",displayName:"Clave",width:"8%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.id}}" ng-bind-html="row.entity.id">{{row.entity.id}}</div>'},{field:"descripcion",displayName:"Descripción del Artículo",width:"25%",headerCellClass:"text-center",cellClass:"text-left",cellTemplate:'<div class="ui-grid-cell-contents left" title="{{row.entity.descripcion}}" ng-bind-html="row.entity.descripcion">{{row.entity.descripcion}}</div>'},{field:"modelo",displayName:"Modelo",width:"25%",headerCellClass:"text-center",cellClass:"text-left",cellTemplate:'<div class="ui-grid-cell-contents left" title="{{row.entity.modelo}}" ng-bind-html="row.entity.modelo">{{row.entity.modelo}}</div>'},{field:"cantidad",displayName:"Cantidad",width:"10%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center"> <input type="text" id="txtCantidad" ng-model="row.entity.cantidad" ng-change="grid.appScope.vm.calcularImporte(row)" solo-numeros maxlength="3"> </div>'},{field:"precio",displayName:"Precio",width:"13%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.precio}}" ng-bind-html="row.entity.precio">{{row.entity.precio}}</div>'},{field:"importe",displayName:"Importe",width:"14%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.importe}}" ng-bind-html="row.entity.importe">{{row.entity.importe}}</div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.eliminarRenglon(row)"> <i class="fa fa-remove" style="font-size:25px;color:red" title = "Eliminar Art&iacute;culo"></i> </a> </div> </div>'}],data:r.registroVentas},r.eliminarRenglonVenta=function(e){var t=parseInt(e.entity.folio),n=r.gridApi.grid.renderContainers.body.visibleRowCache.indexOf(e);swal({title:"",text:"¿Está seguro de eliminar la venta del registro del catálogo?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"OK",cancelButtonText:"Cancelar",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&l.eliminarVenta(t).then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):(swal("",e.mensaje,"success"),
r.ventas.splice(n,1),r.gridOptionsVenta.data=r.ventas)},function(e){swal("","Ocurrió un error al conectar con el servicio [eliminarRenglon]","error")})})},r.cambiaSelectCliente=function(){r.deshabilCliente=!0;var e=document.getElementById("cmbClientes").selectedIndex;r.rfcCliente=r.datosCliente[e].rfc,r.nomCliente=r.datosCliente[e].nombre,r.verRFC=!0,r.deshabilitaArticulo=!1,document.getElementById("cmbArticulos").focus()},r.cambiaSelectArticulo=function(){},r.agregarArticulo=function(){if(r.articuloSelecto.length>0&&0==r.deshabilitaArticulo){a.start("Cargando...");for(var e=0;e<r.articuloSelecto.length;e++){var t=r.articuloSelecto[e];r.validarExistencia(t)}r.deshabilitaArticulo=!0}},r.verDetalle=function(e){r.modalFolio=e.entity.folio,r.modalCliente=e.entity.clavecliente,r.modalNombre=e.entity.nombre,r.modalTotal=e.entity.total,r.modalFecha=e.entity.fecha,r.modalPlazo=e.entity.plazo,r.modalAbono=e.entity.abono,r.modalTotalPagar=e.entity.totalpagar,r.modalAhorro=e.entity.ahorro,$(document).ready(function(){$("#modalDetalle").modal({show:!0})})},r.obtenerDatosCliente=function(){l.obtenerDatosCliente().then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):r.datosCliente=e.data},function(e){swal("","Ocurrió un error al conectar con el servicio [obtenerDatosCliente]","error")})},r.obtenerDatosArticulo=function(){l.obtenerDatosArticulo().then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):r.datosArticulo=e.data},function(e){swal("","Ocurrió un error al conectar con el servicio [obtenerDatosArticulo]","error")})},r.obtenerConfirugacion=function(){a.start("Cargando..."),l.obtenerConfirugacion().then(function(e){1!=e.estatus?(swal("","No se han configurado los datos para el cálculo del monto, favor de verificar"),a.stop()):(r.configuracion=e.data,a.stop())},function(e){a.stop(),swal({title:"",text:"Ocurrió un error al conectar con el servicio [obtenerConfigucacion]",type:"error",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&i.go("app.home")})})},r.consultarVentas=function(){a.start("Cargando..."),l.consultarVentas().then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),a.stop()):(r.ventas=e.data,r.gridOptions.data=r.ventas,a.stop())},function(e){a.stop(),swal("","Ocurrió un error al conectar con el servicio [consultarVentas]","error")})},r.consultarVentas(),r.consultarFolio=function(){l.consultarFolio().then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):r.folioVenta=e.data.sig_folio},function(e){swal({title:"",text:"Ocurrió un error al conectar con el servicio [consultarFolio]",type:"error",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&i.go("app.home")})})},r.nuevaVenta=function(){r.seccionNuevo=!0,r.deshabilCliente=!1,r.deshabilitaArticulo=!0,r.consultarFolio(),r.obtenerConfirugacion(),r.obtenerDatosCliente(),r.obtenerDatosArticulo()},r.calcularImporte=function(e){var t=null,n=null,o=null;r.verTabla=!1,r.nombreBoton="Siguiente",r.tablaAbonos=[],parseInt(e.entity.cantidad)>parseInt(e.entity.existencia)?(swal("","No puede capturar mas unidades de las que hay en existencia ("+e.entity.existencia+")","warning"),e.entity.cantidad=e.entity.unidadesAnterior,r.siguiente=!1):0!=parseInt(e.entity.cantidad)?(r.unidades=parseInt(e.entity.cantidad),r.unidadesAnt=parseInt(e.entity.unidadesAnterior),e.entity.importe=(e.entity.cantidad*e.entity.precio).toFixed(2),r.calcularTotales(),r.unidades>t?(n=r.unidades-r.unidadesAnt,r.actualizarExistencia(e.entity.id,n,0),e.entity.unidadesAnterior=r.unidades):r.unidades<t&&(o=t-r.unidades,r.actualizarExistencia(e.entity.id,o,1),e.entity.unidadesAnterior=r.unidades),r.siguiente=!0):(r.siguiente=!1,r.enganche="",r.bonifEnganche="",r.totalPagar="",e.entity.importe=0)},r.calcularTotales=function(){for(var e=0,t=r.gridApiVenta.core.getVisibleRows(r.gridApiVenta.grid),n=0;n<t.length;n++)e+=parseFloat(t[n].entity.importe);r.enganche=r.configuracion.porcentaje/100*e,r.bonifEnganche=r.enganche*(r.configuracion.tasa*r.configuracion.plazo/100),r.totalPagar=e-r.enganche-r.bonifEnganche,r.totalAdeudo=r.totalPagar.toFixed(2),r.bonifEnganche=r.bonifEnganche.toLocaleString("us",{minimumFractionDigits:2,maximumFractionDigits:2}),r.enganche=r.enganche.toLocaleString("us",{minimumFractionDigits:2,maximumFractionDigits:2}),r.totalPagar=r.totalPagar.toLocaleString("us",{minimumFractionDigits:2,maximumFractionDigits:2})},r.validarExistencia=function(e){l.validarExistencia(e).then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),a.stop()):(r.registroVentas.push(e.data[0]),r.gridOptionsVenta.data=r.registroVentas,a.stop())},function(e){a.stop(),swal("","Ocurrió un error al conectar con el servicio [validarExistencia]","error"),r.cancelar()})},r.eliminarRenglon=function(e){var t=r.gridApiVenta.grid.renderContainers.body.visibleRowCache.indexOf(e);r.gridApiVenta.core.getVisibleRows(r.gridApiVenta.grid);r.registroVentas.splice(t,1),r.gridOptionsVenta.data=r.registroVentas,r.actualizarExistencia(e.entity.id,e.entity.unidadesAnterior,1)},r.siguienteGuardar=function(){if("Siguiente"==r.nombreBoton)r.siguiente?(r.formarObjetoTabla(),r.verTabla=!0,r.nombreBoton="Guardar"):swal("","Los datos ingresados no son correctos, favor de verificar","warning");else if(r.guardar){a.start("Guardando información...");var e={};e.claveCliente=parseInt(r.clienteSelecto[0]),e.nombre=r.nomCliente,e.totalAdeudo=r.totalAdeudo,e.plazo=r.plazoSeleccionado,e.abono=r.abonoSeleccionado,e.totalPagar=r.totalPagarSelecc,e.ahorrro=r.ahorroSeleccionado,l.grabarVenta(e).then(function(e){1!=e.estatus?(a.stop(),swal("",e.mensaje,"warning")):(r.registroVentas=[],swal({title:"",text:"Bien hecho, Tu venta ha sido registrada correctamente",type:"success",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&r.cancelar()}),a.stop())},function(e){a.stop(),swal("","Ocurrió un error al conectar con el servicio [siguienteGrabar]","error")})}else swal("","Debe seleccionar un plazo para realizar el pago de su compra","warning")},r.actualizarExistencia=function(e,t,n){l.actualizarExistencia(e,t,n).then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):r.calcularTotales()},function(e){swal("","Ocurrió un error al conectar con el servicio [actualizarExistencia]")})},r.formarObjetoTabla=function(){var e=0;r.precioContado=(r.totalAdeudo/(1+r.configuracion.tasa*r.configuracion.plazo/100)).toFixed(2);for(var t=0;t<r.plazos.length;t++){var n=r.plazos[t],o={};e=(r.precioContado*(1+r.configuracion.tasa*n/100)).toFixed(2),o.plazo=n,o.abono=(e/n).toFixed(2),o.totalPagar=e,o.ahorra=(r.totalAdeudo-e).toFixed(2),r.tablaAbonos.push(o)}},r.validarPlazo=function(e){r.guardar=!0,r.plazoSeleccionado=r.tablaAbonos[e].plazo,r.abonoSeleccionado=r.tablaAbonos[e].abono,r.ahorroSeleccionado=r.tablaAbonos[e].ahorra,r.totalPagarSelecc=r.tablaAbonos[e].totalPagar},r.cancelar=function(){r.nombreBoton="Siguiente",r.verTabla=!1,r.siguiente=!1,r.registroVentas=[],r.gridOptionsVenta.data=r.registroVentas,r.consultarVentas(),r.seccionNuevo=!1,r.enganche=0,r.bonifEnganche=0,r.totalPagar=0,r.verRFC=!1,r.clienteSelecto=null,r.articuloSelecto=null}}])}(),function(){"use strict";angular.module("articulos").controller("Articulos",["Servarticulos","$state","blockUI",function(e,t,n){var o=this,a=e;o.claveArticulo=null,o.descripcion=null,o.modelo=null,o.precio=null,o.existencia=null,o.actualizar=0,o.articulos=[],o.seccionNuevo=!1,o.nomBoton="Guardar";var i=document.getElementById("txtDescripcion"),r=(document.getElementById("txtModelo"),document.getElementById("txtPrecio")),l=document.getElementById("txtExistencia");o.gridOptions={onRegisterApi:function(e){o.gridApi=e},enablePaginationControls:!1,enableFullRowSelection:!1,enableRowSelection:!1,enableSelectAll:!0,selectionRowHeaderWidth:35,enableRowHeaderSelection:!0,enableColumnMenus:!1,enableSorting:!0,enableFiltering:!1,showColumnFooter:!1,columnDefs:[{field:"clave",displayName:"Clave Artículo",width:"10%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.clave}}" ng-bind-html="row.entity.clave">{{row.entity.clave}}</div>'},{field:"descripcion",displayName:"Descripcion",width:"25%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.descripcion}}" ng-bind-html="row.entity.descripcion">{{row.entity.descripcion}}</div>'},{field:"modelo",displayName:"Modelo",width:"25%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.modelo}}" ng-bind-html="row.entity.modelo">{{row.entity.modelo}}</div>'},{field:"precio",displayName:"Precio",width:"15%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.precio}}" ng-bind-html="row.entity.precio">{{row.entity.precio}}</div>'},{field:"existencia",displayName:"Existencia",width:"15%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center" title="{{row.entity.existencia}}" ng-bind-html="row.entity.existencia">{{row.entity.existencia}}</div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents center"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.editarArticulo(row)"> <i class="fa fa-edit" style="font-size:25px;color:green" title = "Editar Art&iacute;culo"></i> </a> </div> </div>'},{field:"0",displayName:" ",width:"5%",headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents"> <div class="hidden-sm hidden-xs action-buttons"> <a class="blue" ng-click="grid.appScope.vm.eliminarRenglon(row)"> <i class="fa fa-remove" style="font-size:25px;color:red" title = "Eliminar Art&iacute;culo"></i> </a> </div> </div>'}],data:o.articulos},o.eliminarRenglon=function(e){var t=parseInt(e.entity.clave),n=o.gridApi.grid.renderContainers.body.visibleRowCache.indexOf(e);swal({title:"",text:"¿Está seguro de eliminar el artículo del catálogo?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"OK",cancelButtonText:"Cancelar",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&a.eliminarArticulo(t).then(function(e){1!=e.estatus?swal("",e.mensaje,"warning"):(swal("",e.mensaje,"success"),o.articulos.splice(n,1),o.gridOptionsVenta.data=o.articulos)})})},o.consultarArticulos=function(){n.start("Cargando..."),a.consultarArticulos().then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),n.stop()):(o.articulos=e.data,o.gridOptions.data=o.articulos,n.stop())},function(e){swal("","Ocurrió un error al conectar con el servicio [consultarArticulos]","error"),n.stop()})},o.consultarArticulos(),o.editarArticulo=function(e){o.nomBoton="Actualizar",o.actualizar=1,o.descripcion=e.entity.descripcion,o.modelo=e.entity.modelo,o.precio=e.entity.precio,o.existencia=e.entity.existencia,o.claveArticulo=e.entity.clave,o.seccionNuevo=!0},o.altaNuevo=function(){o.seccionNuevo=!0,o.descripcion=null,o.modelo=null,o.precio=null,o.existencia=null,o.claveArticulo=null,o.obtenerSiguiente()},o.obtenerSiguiente=function(){a.obtenerSiguiente().then(function(e){1!=e.estatus?swal({title:"",text:e.mensaje,type:"error",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&o.cancelar()}):(o.claveArticulo=e.data.sig_id,document.getElementById("txtDescripcion").focus())},function(e){swal("","Ocurrió un error al conectar con el servicio [obtenerSiguiente]","error")})},o.validarPrecio=function(){var e=o.precio.length,t=0,n=0;o.precio.length>1&&(t=o.precio.indexOf("."),n=o.precio.lastIndexOf("."),t!=n&&(alert("No puede teclear dos puntos en este control"),o.precio=o.precio.substr(0,e-1)))},o.guardar=function(){var e=parseInt(o.claveArticulo),t=null;t=null==o.modelo?"' '":o.modelo,null==o.descripcion||""==o.descripcion?(alert("No es posible continuar, debe ingresar la Descripción, es obligatorio"),i.focus()):null==o.precio||""==o.precio?(alert("No es posible continuar, debe ingresar el Precio, es obligatorio"),r.focus()):null==o.existencia||""==o.existencia?(alert("No es posible continuar, debe ingresar la Existencia, es obligatorio"),l.focus()):(n.start("Guardando información..."),a.guardarArticulo(o.actualizar,o.descripcion,t,o.precio,o.existencia,e).then(function(e){1!=e.estatus?(swal("",e.mensaje,"warning"),n.stop()):(n.stop(),swal({title:"",text:e.mensaje,type:"success",showCancelButton:!1,confirmButtonClass:"btn-primary",confirmButtonText:"OK",closeOnConfirm:!0},function(e){e&&(o.seccionNuevo=!1,o.consultarArticulos())}))},function(e){n.stop(),swal("","Ocurrió un error al conectar con el servicio [guardar]","error")}))},o.cancelar=function(){o.descripcion=null,o.modelo=null,o.precio=null,o.existencia=null,o.seccionNuevo=!1,o.claveArticulo=null,o.articulos=[],o.actualizar=0,o.nomBoton="Guardar",o.consultarArticulos()}}])}();